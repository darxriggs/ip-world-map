#!/usr/bin/env ruby

require 'rubygems'
require 'ip-world-map'

log_files = Dir.glob(ARGV)
if (log_files.empty?) then puts 'no files given'; exit(1) end

analyzer = ApacheLogAnalyzer.new(log_files)
analyzer.load_cached_coordinates_from_file

details = analyzer.analyze
details_per_timeslot = analyzer.group_by_time(details, 24 * 60 * 60)

p analyzer.stats
p "timeslots: #{details_per_timeslot.size}"
details_per_timeslot.sort().each{ |timeslot, values| p "#{timeslot}: #{values.size} entries" }

